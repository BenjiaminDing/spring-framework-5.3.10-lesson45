![image-20221029224007731](D:\音乐图片\typora图片\image-20221029224007731.png)



==涉及抽象BeanDefinition--以及合并后RootBeanDefinition==



```
refresh()---	生成非懒加载的单例beanfinishBeanFactoryInitialization(beanFactory);---	03	实例化非懒加载的单例BeanbeanFactory.preInstantiateSingletons();---  04DefaultListableFactory.preInstantiateSingletons()----05getMergedLocalBeanDefinition(beanName);

```

![image-20221030174338372](D:\音乐图片\typora图片\image-20221030174338372.png)



==涉及到Bean   FactoryBean和SmartFactoryBean区别==



```
01--如果是实现FactoryBean 在getbean（）方法时候才调用getObject(){ new UserService()}
02--对比如果实现SmartFactoryBean接口  ，该接口里面多出一个方法 isEagerInit（）{ return  false}  如果ZhouyuFactoryBean实现SmartFactoryBean接口重写isEagerInit方法return true 就会不一样了 就是spring启动的时候（
 new AnnotationConfigApplicationContext(AppConfig.class)）就会调用getObject(){ new UserService()}  方法，
 
 ---如果
```

![image-20221102220119984](D:\音乐图片\typora图片\image-20221102220119984.png)

```
System.out.println(context.getBean("zhouyuFactoryBean"));  //  从cashe中获取  拿到是userService  com.zhouyu.service.UserService@fa36558
System.out.println(context.getBean("&zhouyuFactoryBean"));  //从单例池中获取zhouyuFactoryBean   拿到是 com.zhouyu.service.UserService@fa36558
```

![image-20221102220351903](D:\音乐图片\typora图片\image-20221102220351903.png)

![image-20221102232437109](D:\音乐图片\typora图片\image-20221102232437109.png)







----





